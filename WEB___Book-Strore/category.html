<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Nh√† S√°ch Online</title>
    <link rel="icon" type="image/jpg" href="images/Logo_pic_removebg.png" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="bootstrap-5.3.2-dist/css/bootstrap.min.css" />

    <style>
      .container {
        margin: 5rem auto;
      }
      /* Container ch√≠nh cho b·ªô l·ªçc n√¢ng cao */
      .advanced-filters {
        display: flex;
        gap: 15px;
        padding: 20px;
        margin: 20px 0;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        align-items: center;
        flex-wrap: wrap;
        border: 1px solid #dee2e6;
      }

      /* Item ch·ª©a m·ªói b·ªô l·ªçc */
      .filter-item {
        position: relative;
        display: inline-block;
        padding-bottom: 8px;
      }

      .filter-item::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        height: 8px;
        background: transparent;
      }

      /* N√∫t b·ªô l·ªçc */
      .filter-btn {
        background: #ffffff;
        color: #2c3e50;
        padding: 12px 20px;
        border: 2px solid #e0e0e0;
        cursor: pointer;
        border-radius: 8px;
        font-size: 15px;
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        min-width: 160px;
      }

      .filter-btn:hover {
        background: #f8f9fa;
        border-color: #007bff;
        color: #007bff;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 123, 255, 0.15);
      }

      .filter-btn:active {
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }

      /* Dropdown menu */
      .filter-dropdown {
        list-style-type: none;
        padding: 8px 0;
        margin: 0;
        position: absolute;
        top: calc(100% + 8px);
        left: 0;
        z-index: 1000;
        background-color: #ffffff;
        border: 1px solid #e0e0e0;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        min-width: 200px;
        display: none;
        border-radius: 8px;
        overflow: hidden;
        animation: slideDown 0.2s ease;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .filter-item:hover .filter-dropdown,
      .filter-item.open .filter-dropdown {
        display: block;
      }

      .filter-item .filter-dropdown {
        transition: opacity 0.6s ease 3s, visibility 0.6s ease 3s;
        opacity: 0;
        visibility: hidden;
      }

      .filter-item:hover .filter-dropdown,
      .filter-item.open .filter-dropdown {
        opacity: 1;
        visibility: visible;
        display: block;
        transition-delay: 0s;
      }

      /* Item trong dropdown */
      .filter-dropdown li {
        margin: 0;
        padding: 0;
      }

      .filter-dropdown li a {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 22px;
        text-decoration: none;
        color: #495057;
        white-space: nowrap;
        transition: all 0.2s ease;
        font-size: 15px;
        font-weight: 400;
      }

      .filter-dropdown li a:hover {
        background: linear-gradient(90deg, #e3f2fd 0%, #bbdefb 100%);
        color: #1976d2;
        padding-left: 24px;
      }

      .filter-dropdown li:first-child a {
        border-radius: 8px 8px 0 0;
      }

      .filter-dropdown li:last-child a {
        border-radius: 0 0 8px 8px;
      }

      /* B·ªï sung CSS cho l·ªçc kho·∫£ng gi√° */
      .price-range-dropdown {
        list-style-type: none !important;
        padding: 15px !important;
        min-width: 250px !important;
        transition: none !important;
      }
      .price-range-dropdown input[type="number"] {
        box-sizing: border-box;
      }

      /* N√∫t x√≥a t√¨m ki·∫øm n√¢ng cao */
      .clear-filters-btn {
        margin-left: auto;
        text-decoration: none;
        color: black;
        padding: 10px 18px;
        border: 2px solid #dc3545;
        color: rgb(255, 255, 255);
        padding: 10px 18px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 700;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        box-shadow: 0 2px 4px rgba(10, 9, 10, 0.1);
      }

      .clear-filters-btn:hover {
        background-color: #c82333;
        color: #ffffff;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(15, 0, 2, 0.3);
      }

      .clear-filters-btn:active {
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(7, 0, 1, 0.1);
      }

      .clear-filters-btn.active-clear {
        background-color: #dc3545;
        color: #000000;
        border-color: #dc3545;
        font-weight: 900;
      }

      /* Ph·∫ßn hi·ªÉn th·ªã b·ªô l·ªçc ƒë√£ ch·ªçn */
      .selected-filters {
        padding: 15px 20px;
        margin: 0 0 20px 0;
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }

      .selected-filters h1 {
        font-size: 16px;
        font-weight: 600;
        color: #856404;
        margin: 0;
        padding: 0;
      }

      .selected-filters .filter-tag {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: #ffffff;
        color: #495057;
        padding: 6px 12px;
        margin: 5px 5px 0 0;
        border-radius: 6px;
        font-size: 13px;
        border: 1px solid #dee2e6;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .selected-filters .filter-tag .remove-filter {
        cursor: pointer;
        color: #dc3545;
        font-weight: bold;
        transition: color 0.2s;
      }

      .selected-filters .filter-tag .remove-filter:hover {
        color: #bd2130;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .advanced-filters {
          flex-direction: column;
          align-items: stretch;
          gap: 10px;
        }

        .filter-item {
          width: 100%;
        }

        .filter-btn {
          width: 100%;
          justify-content: space-between;
        }

        .filter-dropdown {
          width: 100%;
          min-width: auto;
        }

        .clear-filters-btn {
          width: 100%;
          justify-content: center;
          margin-left: 0;
        }
      }

      .filter-btn.loading {
        opacity: 0.6;
        cursor: not-allowed;
        pointer-events: none;
      }

      .filter-btn.loading::after {
        content: "";
        width: 12px;
        height: 12px;
        border: 2px solid #007bff;
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 0.6s linear infinite;
        margin-left: 8px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .filter-btn.active {
        background: #007bff;
        color: #ffffff;
        border-color: #007bff;
      }

      .filter-btn.active:hover {
        background: #0056b3;
        border-color: #0056b3;
      }

      .filter-count {
        background: #dc3545;
        color: #ffffff;
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 11px;
        font-weight: 600;
        margin-left: 4px;
      }

      .product-author {
        margin: 0.3rem 0 0.8rem 0 !important;
        font-size: 14px !important;
        color: #6c757d !important;
        font-weight: 400 !important;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .product-info {
        padding: 10px;
        display: flex !important;
        flex-direction: column !important;
        justify-content: space-between !important;
        flex-grow: 1 !important;
      }

      .product-card h3 {
        margin-bottom: 0.5rem !important;
      }

      .product-card .price {
        position: static !important;
        margin-bottom: 1rem !important;
      }
    </style>
  </head>

  <body>
    <!-- HEADER -->
    <header class="topbar">
      <div class="logo">
        <a href="index.html">
          <img class="Logo" src="images/Logo_removebg.png" alt="Logo" />
          <img
            class="Word"
            src="images/Logo_word_removebg.png"
            alt="Literary Haven"
          />
        </a>
      </div>

      <div class="auth-cart">
        <div id="authArea">
          <button class="btn-auth" onclick="openLoginModal()">ƒêƒÉng nh·∫≠p</button>
          <button class="btn-auth btn-signup" onclick="openRegisterModal()">
            ƒêƒÉng k√Ω
          </button>
        </div>
      </div>
    </header>

    <!-- NAV -->
    <nav class="navbar" id="mainNav">
      <ul class="menu" id="mainMenu">
        <li><a href="index.html">Trang ch·ªß</a></li>
        <li><a href="about.html">Gi·ªõi thi·ªáu</a></li>
        <div class="category-menu">
          <button
            class="category-btn"
          >
            Danh m·ª•c ‚ñæ
          </button>

          <ul class="book-filter">
            <li class="dropdown">
              <a href="category.html?category=VƒÉn h·ªçc" data-category="VƒÉn h·ªçc"
                >VƒÉn h·ªçc ‚ñ∏</a
              >
              <ul class="dropdown-content">
                <li>
                  <a
                    href="category.html?category=VƒÉn h·ªçc&subcategory=Ti·ªÉu thuy·∫øt"
                    >Ti·ªÉu thuy·∫øt</a
                  >
                </li>
                <li>
                  <a
                    href="category.html?category=VƒÉn h·ªçc&subcategory=Truy·ªán ng·∫Øn"
                    >Truy·ªán ng·∫Øn</a
                  >
                </li>
                <li>
                  <a href="category.html?category=VƒÉn h·ªçc&subcategory=Th∆°"
                    >Th∆°</a
                  >
                </li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="category.html?category=Kinh t·∫ø">Kinh t·∫ø ‚ñ∏</a>
              <ul class="dropdown-content">
                <li>
                  <a href="category.html?category=Kinh t·∫ø&subcategory=Qu·∫£n tr·ªã"
                    >Qu·∫£n tr·ªã</a
                  >
                </li>
                <li>
                  <a href="category.html?category=Kinh t·∫ø&subcategory=T√†i ch√≠nh"
                    >T√†i ch√≠nh</a
                  >
                </li>
                <li>
                  <a href="category.html?category=Kinh t·∫ø&subcategory=Marketing"
                    >Marketing</a
                  >
                </li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="category.html?category=Thi·∫øu nhi">Thi·∫øu nhi ‚ñ∏</a>
              <ul class="dropdown-content">
                <li>
                  <a
                    href="category.html?category=Thi·∫øu nhi&subcategory=Truy·ªán tranh"
                    >Truy·ªán tranh</a
                  >
                </li>
                <li>
                  <a
                    href="category.html?category=Thi·∫øu nhi&subcategory=Gi√°o d·ª•c"
                    >Gi√°o d·ª•c</a
                  >
                </li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="category.html?category=Gi√°o khoa">Gi√°o khoa ‚ñ∏</a>
              <ul class="dropdown-content">
                <li>
                  <a href="category.html?category=Gi√°o khoa&subcategory=C·∫•p 1"
                    >C·∫•p 1</a
                  >
                </li>
                <li>
                  <a href="category.html?category=Gi√°o khoa&subcategory=C·∫•p 2"
                    >C·∫•p 2</a
                  >
                </li>
                <li>
                  <a href="category.html?category=Gi√°o khoa&subcategory=C·∫•p 3"
                    >C·∫•p 3</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
        <li><a href="news.html">Tin t·ª©c</a></li>
      </ul>
    </nav>

    <!-- T√¨m ki·∫øm v√† gi·ªè h√†ng -->
    <div class="nav_2">
      <div class="search-center">
        <input
          id="topSearch"
          class="search-input"
          type="text"
          placeholder="Nh·∫≠p t√™n cu·ªën s√°ch b·∫°n ƒëang t√¨m ..."
          autocomplete="off"
        />
        <button class="search-btn" type="button">T√¨m ki·∫øm</button>
      </div>
      <div class="cart-float" id="cartFloat">
        <button id="cartBtnFloat" class="btn">
          <span class="cart-icon">üõí</span>
          <span id="cart-count" class="cart-count">0</span>
        </button>
      </div>
    </div>

    <main class="container">
      <div class="products-top">
        <button
          class="breadcrumb-btn"
          id="breadcrumb-category"
          onclick="window.location.href='category.html'"
        >
          T·∫•t c·∫£ s√°ch
        </button>
      </div>

      <div class="advanced-filters">
        <div class="filter-item">
          <button class="filter-btn">Theo th·ªÉ lo·∫°i ‚ñæ</button>
          <ul class="filter-dropdown" id="subcategory-dropdown"></ul>
        </div>

        <div class="filter-item">
          <button class="filter-btn">Theo t√™n s√°ch ‚ñæ</button>
          <ul class="filter-dropdown">
            <li><a href="#">A ‚Üí Z</a></li>
            <li><a href="#">Z ‚Üí A</a></li>
          </ul>
        </div>

        <div class="filter-item">
          <button class="filter-btn">Theo t√°c gi·∫£ ‚ñæ</button>
          <ul class="filter-dropdown">
            <li><a href="#">A ‚Üí Z</a></li>
            <li><a href="#">Z ‚Üí A</a></li>
          </ul>
        </div>

        <div class="filter-item">
          <button class="filter-btn" id="price-filter-btn">
            Theo gi√° (kho·∫£ng) ‚ñæ
          </button>
          <div
            class="filter-dropdown price-range-dropdown"
            style="padding: 15px; min-width: 250px"
          >
            <div style="margin-bottom: 10px">
              <label
                for="min-price"
                style="display: block; font-size: 14px; margin-bottom: 5px"
                >Gi√° T·ªëi Thi·ªÉu (‚Ç´)</label
              >
              <input
                type="text"
                id="min-price"
                placeholder="V√≠ d·ª•: 50.000"
                style="
                  width: 100%;
                  padding: 8px;
                  border: 1px solid #ccc;
                  border-radius: 4px;
                "
              />
            </div>
            <div style="margin-bottom: 10px">
              <label
                for="max-price"
                style="display: block; font-size: 14px; margin-bottom: 5px"
                >Gi√° T·ªëi ƒêa (‚Ç´)</label
              >
              <input
                type="text"
                id="max-price"
                placeholder="V√≠ d·ª•: 200.000"
                style="
                  width: 100%;
                  padding: 8px;
                  border: 1px solid #ccc;
                  border-radius: 4px;
                "
              />
            </div>
            <button
              id="apply-price-filter"
              style="
                width: 100%;
                padding: 10px;
                background-color: #007bff;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                margin-top: 10px;
                font-weight: 600;
              "
            >
              √Åp d·ª•ng
            </button>
          </div>
        </div>
        <a href="./category.html" class="clear-filters-btn"
          >X√≥a t·∫•t c·∫£ t√¨m ki·∫øm n√¢ng cao</a
        >
      </div>

      <div class="selected-filters" id="selectedFilters">
        <h1>T√¨m ki·∫øm n√¢ng cao:</h1>
      </div>

      <div id="product-list" class="products-grid"></div>

      <div id="pagination" class="pagination"></div>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <h3>V·ªÅ Ch√∫ng t√¥i</h3>
          <ul>
            <li><a href="about.html">Gi·ªõi thi·ªáu</a></li>
            <li><a href="./news.html">Tin t·ª©c</a></li>
            <li><a href="./privacy_policy.html">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
            <li><a href="./terms-of-use.html">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h3>H·ªó tr·ª£ kh√°ch h√†ng</h3>
          <ul>
            <li><a href="./shopping_guide.html">H∆∞·ªõng d·∫´n mua h√†ng</a></li>
            <li><a href="./exchange-policy.html">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
            <li><a href="./warranty-policy.html">Ch√≠nh s√°ch b·∫£o h√†nh</a></li>
            <li>
              <a href="./frequently-asked-questions.html">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a>
            </li>
          </ul>
        </div>

        <div class="footer-section">
          <h3>Ch√≠nh s√°ch</h3>
          <ul>
            <li><a href="./payment-policy.html">Ch√≠nh s√°ch thanh to√°n</a></li>
            <li><a href="./shipping-policy.html">Ch√≠nh s√°ch v·∫≠n chuy·ªÉn</a></li>
            <li><a href="./warranty-policy.html">Ch√≠nh s√°ch b·∫£o h√†nh</a></li>
            <li><a href="./exchange-policy.html">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
          </ul>
        </div>

        <div class="footer-section contact-info">
          <h3>Li√™n h·ªá</h3>
          <p>üìç 123 Nguy·ªÖn VƒÉn Linh, Q7, TP.HCM</p>
          <p>üìû Hotline: 1900 xxxx</p>
          <p>‚úâÔ∏è Email: support@bookstore.vn</p>
          <p>üïê Gi·ªù l√†m vi·ªác: 8:00 - 22:00</p>
          <div class="social-links">
            <a
              href="https://www.facebook.com/profile.php?id=100052833923582"
              target="_blank"
              >f</a
            >
            <a href="https://www.instagram.com/tungoc0405/" target="_blank"
              >üì∑</a
            >
            <a
              href="https://www.tiktok.com/@traitehaykhoc?_r=1&_t=ZS-91B13gORPSj&fbclid=IwY2xjawN5oDdleHRuA2FlbQIxMQBzcnRjBmFwcF9pZAEwAAEeiMoX6IjEFBeNLnfX-py5cmpb7Jgn6OXNenvCTQMTmY3ovQAOjYmzsv--T9c_aem_FPRe5Jbt4h2M9pfrpkpJ_g"
              target="_blank"
              >‚ô™</a
            >
            <a
              href="https://www.messenger.com/t/6985295158239286/"
              target="_blank"
              >üì±</a
            >
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Book Store. All rights reserved. | Designed with ‚ù§Ô∏è</p>
      </div>
    </footer>

    <div id="loginModal" class="auth-modal">
      <div class="auth-modal-overlay" onclick="closeLoginModal()"></div>
      <div class="auth-modal-content">
        <button class="auth-modal-close" onclick="closeLoginModal()">
          &times;
        </button>

        <div class="auth-modal-header">
          <h2>ƒêƒÉng Nh·∫≠p</h2>
          <p>Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i!</p>
        </div>

        <form id="login-form" class="auth-modal-form">
          <div class="form-group">
            <label for="login-username">T√™n t√†i kho·∫£n</label>
            <div class="input-with-icon">
              <span class="input-icon">üë§</span>
              <input
                type="text"
                id="login-username"
                placeholder="Nh·∫≠p t√™n t√†i kho·∫£n"
              />
            </div>
            <span id="error-login-username" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="login-password">M·∫≠t kh·∫©u</label>
            <div class="input-with-icon">
              <span class="input-icon">üîí</span>
              <input
                type="password"
                id="login-password"
                placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
              />
              <span
                class="password-toggle"
                id="toggle-login-password"
                onclick="togglePassword('login-password', 'toggle-login-password')"
                >üëÅÔ∏è‚Äçüó®Ô∏è</span
              >
            </div>
            <span id="error-login-password" class="error-msg"></span>
          </div>

          <button type="submit" class="btn-auth-submit">ƒêƒÉng Nh·∫≠p</button>
        </form>

        <div class="auth-modal-footer">
          Ch∆∞a c√≥ t√†i kho·∫£n?
          <a href="#" onclick="switchToRegister()">ƒêƒÉng k√Ω ngay</a>
        </div>
      </div>
    </div>

    <div id="registerModal" class="auth-modal">
      <div class="auth-modal-overlay" onclick="closeRegisterModal()"></div>
      <div class="auth-modal-content">
        <button class="auth-modal-close" onclick="closeRegisterModal()">
          &times;
        </button>

        <div class="auth-modal-header">
          <h2>ƒêƒÉng K√Ω</h2>
          <p>T·∫°o t√†i kho·∫£n m·ªõi c·ªßa b·∫°n</p>
        </div>

        <form
          id="register-form"
          class="auth-modal-form"
          style="max-height: 450px; overflow-y: auto"
        >
          <div class="form-group">
            <label for="reg-fullname">H·ªç v√† t√™n</label>
            <div class="input-with-icon">
              <span class="input-icon">üë§</span>
              <input
                type="text"
                id="reg-fullname"
                placeholder="Nh·∫≠p h·ªç v√† t√™n"
              />
            </div>
            <span id="error-fullname" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-username">T√†i kho·∫£n</label>
            <div class="input-with-icon">
              <span class="input-icon">üîë</span>
              <input
                type="text"
                id="reg-username"
                placeholder="Nh·∫≠p t√†i kho·∫£n"
              />
            </div>
            <span id="error-username" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-password">M·∫≠t kh·∫©u</label>
            <div class="input-with-icon">
              <span class="input-icon">üîí</span>
              <input
                type="password"
                id="reg-password"
                placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
              />
              <span
                class="password-toggle"
                id="toggle-reg-password"
                onclick="togglePassword('reg-password', 'toggle-reg-password')"
                >üëÅÔ∏è‚Äçüó®Ô∏è</span
              >
            </div>
            <span id="error-password" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-confirm-password">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u</label>
            <div class="input-with-icon">
              <span class="input-icon">üîí</span>
              <input
                type="password"
                id="reg-confirm-password"
                placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
              />
              <span
                class="password-toggle"
                id="toggle-reg-confirm"
                onclick="togglePassword('reg-confirm-password', 'toggle-reg-confirm')"
                >üëÅÔ∏è‚Äçüó®Ô∏è</span
              >
            </div>
            <span id="error-confirm-password" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-email">Email</label>
            <div class="input-with-icon">
              <span class="input-icon">üìß</span>
              <input type="email" id="reg-email" placeholder="Nh·∫≠p email" />
            </div>
            <span id="error-email" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-phone">S·ªë ƒëi·ªán tho·∫°i</label>
            <div class="input-with-icon">
              <span class="input-icon">üì±</span>
              <input
                type="tel"
                id="reg-phone"
                placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
              />
            </div>
            <span id="error-phone" class="error-msg"></span>
          </div>

          <div class="form-group">
            <label for="reg-address">ƒê·ªãa ch·ªâ</label>
            <div class="input-with-icon">
              <span class="input-icon">üìç</span>
              <input type="text" id="reg-address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ" />
            </div>
            <span id="error-address" class="error-msg"></span>
          </div>

          <button type="submit" class="btn-auth-submit">ƒêƒÉng K√Ω</button>
        </form>

        <div class="auth-modal-footer">
          ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="switchToLogin()">ƒêƒÉng nh·∫≠p</a>
        </div>
      </div>
    </div>

    <div id="profileModal" class="auth-modal">
      <div class="auth-modal-overlay" onclick="closeProfileModal()"></div>
      <div class="auth-modal-content">
        <button class="auth-modal-close" onclick="closeProfileModal()">
          &times;
        </button>

        <div class="auth-modal-header">
          <div class="profile-avatar-small">üë§</div>
          <h2 id="profile-fullname">Xin ch√†o!</h2>
          <p>Th√¥ng tin t√†i kho·∫£n c·ªßa b·∫°n</p>
        </div>

        <div class="profile-info-modal">
          <div class="info-row">
            <span class="info-label">üë§ H·ªç v√† t√™n:</span>
            <span class="info-value" id="profile-name-value"></span>
          </div>
          <div class="info-row">
            <span class="info-label">üîë T√†i kho·∫£n:</span>
            <span class="info-value" id="profile-username-value"></span>
          </div>
          <div class="info-row">
            <span class="info-label">üìß Email:</span>
            <span class="info-value" id="profile-email-value"></span>
          </div>
          <div class="info-row">
            <span class="info-label">üì± S·ªë ƒëi·ªán tho·∫°i:</span>
            <span class="info-value" id="profile-phone-value"></span>
          </div>
          <div class="info-row">
            <span class="info-label">üìç ƒê·ªãa ch·ªâ:</span>
            <span class="info-value" id="profile-address-value"></span>
          </div>
        </div>

        <button class="btn-logout-modal" onclick="handleLogoutModal()">
          ƒêƒÉng xu·∫•t
        </button>
      </div>
    </div>

    <script src="assets/js/main.js"></script>
    <script src="bootstrap-5.3.2-dist/js/bootstrap.bundle.min.js"></script>

    <a href="#" class="back-to-top" title="L√™n ƒë·∫ßu trang">
      <i class="bi bi-chevron-up">
        <img class="go-up" src="./images/muiten.svg" alt="V·ªÅ trang ch·ªß" />
      </i>
    </a>

    <script>
      // Bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u tr·∫°ng th√°i filter
      let categoryFilters = {
        sortByName: null,
        sortByAuthor: null,
        minPrice: null,
        maxPrice: null,
        category: null,
        subcategory: null,
        filterSubcategory: null, // TH√äM M·ªöI: L·ªçc theo subcategory t·ª´ dropdown
      };

      // Kh·ªüi t·∫°o trang category
      function initCategoryPage() {
        console.log("Initializing category page...");

        // ƒê·ªçc URL params
        const urlParams = new URLSearchParams(window.location.search);
        categoryFilters.category = urlParams.get("category");
        categoryFilters.subcategory = urlParams.get("subcategory");

        console.log("URL Filters:", categoryFilters);

        // C·∫≠p nh·∫≠t breadcrumb
        updateCategoryBreadcrumb();

        // Setup event listeners
        setupCategoryFilterListeners();

        // ‚úÖ Populate subcategory dropdown
        populateSubcategoryDropdown();

        // Load v√† hi·ªÉn th·ªã s·∫£n ph·∫©m
        applyCategoryFilters();

        // C·∫≠p nh·∫≠t UI
        updateSelectedFilters();
        updateClearButton();
      }

      // C·∫≠p nh·∫≠t breadcrumb
      function updateCategoryBreadcrumb() {
        const breadcrumbBtn = document.getElementById("breadcrumb-category");
        if (!breadcrumbBtn) return;

        if (!categoryFilters.category) {
          breadcrumbBtn.textContent = "T·∫•t c·∫£ s√°ch";
        } else if (categoryFilters.subcategory) {
          breadcrumbBtn.textContent = `Danh m·ª•c s√°ch > ${categoryFilters.category} > ${categoryFilters.subcategory}`;
        } else {
          breadcrumbBtn.textContent = `Danh m·ª•c s√°ch > ${categoryFilters.category}`;
        }
      }

      // ‚úÖ TH√äM M·ªöI: H√†m l·∫•y d·ªØ li·ªáu Category t·ª´ Local Storage
      // H√ÄM N√ÄY C·∫¶N PH·∫¢I ƒê∆Ø·ª¢C ƒê·ªäNH NGHƒ®A TRONG main.js C√ôNG V·ªöI H·∫∞NG S·ªê CATEGORIES_STORAGE_KEY
      function getCategoriesFromStorage() {
        // L∆∞u √Ω: C·∫ßn ƒë·∫£m b·∫£o h·∫±ng s·ªë CATEGORIES_STORAGE_KEY ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong main.js
        const storedData = localStorage.getItem("admin_categories_data");
        let categories;
        try {
          // Tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ l∆∞u n·∫øu t·ªìn t·∫°i, ng∆∞·ª£c l·∫°i tr·∫£ v·ªÅ m·∫£ng r·ªóng
          categories = storedData ? JSON.parse(storedData) : [];
        } catch (e) {
          console.error(
            "L·ªói khi ph√¢n t√≠ch d·ªØ li·ªáu categories t·ª´ localStorage:",
            e
          );
          return [];
        }
        return categories;
      }

      // ‚úÖ C·∫¨P NH·∫¨T: Populate subcategory dropdown d·ª±a tr√™n d·ªØ li·ªáu t·ª´ Local Storage
      function populateSubcategoryDropdown() {
        const subcategoryDropdown = document.getElementById(
          "subcategory-dropdown"
        );
        if (!subcategoryDropdown) {
          console.error("Subcategory dropdown not found!");
          return;
        }

        // L·∫•y d·ªØ li·ªáu category t·ª´ Local Storage
        const allCategories = getCategoriesFromStorage();
        // L·ªçc ra c√°c category ƒëang 'active'
        const activeCategories = allCategories.filter(
          (cat) => cat.status === "active"
        );

        // T·∫≠p h·ª£p t·∫•t c·∫£ subcategory duy nh·∫•t t·ª´ c√°c category ƒëang active
        const allSubcategories = [];
        activeCategories.forEach((cat) => {
          cat.subcategories.forEach((sub) => {
            // Ch·ªâ th√™m v√†o n·∫øu subcategory ch∆∞a c√≥ trong danh s√°ch
            if (!allSubcategories.includes(sub)) {
              allSubcategories.push(sub);
            }
          });
        });

        // S·∫Øp x·∫øp c√°c subcategory
        allSubcategories.sort((a, b) => a.localeCompare(b, "vi"));

        console.log("Found subcategories for filter:", allSubcategories);

        // T·∫°o HTML cho dropdown
        let html =
          '<li><a href="#" data-subcategory="">‚ú® T·∫•t c·∫£ th·ªÉ lo·∫°i</a></li>';

        allSubcategories.forEach((sub) => {
          let displayName = sub;
          // Th√™m prefix "GK " cho c√°c c·∫•p h·ªçc (gi·ªØ nguy√™n logic g·ªëc)
          if (sub === "C·∫•p 1" || sub === "C·∫•p 2" || sub === "C·∫•p 3") {
            displayName = "GK " + sub;
          }
          html += `<li><a href="#" data-subcategory="${sub}">üìö ${displayName}</a></li>`;
        });

        subcategoryDropdown.innerHTML = html;

        // G√°n s·ª± ki·ªán click cho c√°c link (gi·ªØ nguy√™n logic g·ªëc)
        subcategoryDropdown.querySelectorAll("a").forEach((link) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            const selectedSub = link.getAttribute("data-subcategory");
            categoryFilters.filterSubcategory = selectedSub || null;

            console.log(
              "Subcategory filter selected:",
              categoryFilters.filterSubcategory
            );

            applyCategoryFilters();
            updateSelectedFilters();
            updateClearButton();
          });
        });

        console.log(
          "Subcategory dropdown populated successfully from Local Storage data"
        );
      }

      // Setup event listeners
      function setupCategoryFilterListeners() {
        console.log("Setting up filter listeners...");

        // L·ªçc theo t√™n truy·ªán (b√¢y gi·ªù l√† child th·ª© 2)
        const nameFilterLinks = document.querySelectorAll(
          ".filter-item:nth-child(2) .filter-dropdown a"
        );
        console.log("Name filter links:", nameFilterLinks.length);

        nameFilterLinks.forEach((link, index) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            console.log("Name filter clicked:", index);
            categoryFilters.sortByName = index === 0 ? "asc" : "desc";
            applyCategoryFilters();
            updateSelectedFilters();
            updateClearButton();
          });
        });

        // L·ªçc theo t√°c gi·∫£ (b√¢y gi·ªù l√† child th·ª© 3)
        const authorFilterLinks = document.querySelectorAll(
          ".filter-item:nth-child(3) .filter-dropdown a"
        );
        console.log("Author filter links:", authorFilterLinks.length);

        authorFilterLinks.forEach((link, index) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            console.log("Author filter clicked:", index);
            categoryFilters.sortByAuthor = index === 0 ? "asc" : "desc";
            applyCategoryFilters();
            updateSelectedFilters();
            updateClearButton();
          });
        });

        // L·ªçc theo kho·∫£ng gi√°
        const applyPriceBtn = document.getElementById("apply-price-filter");
        if (applyPriceBtn) {
          console.log("Price filter button found");
          applyPriceBtn.addEventListener("click", () => {
            console.log("Apply price filter clicked");
            applyPriceFilter();
          });
        } else {
          console.error("Price filter button NOT found");
        }

        // Format input gi√° v·ªõi d·∫•u ch·∫•m ngƒÉn c√°ch
        const minPriceInput = document.getElementById("min-price");
        const maxPriceInput = document.getElementById("max-price");

        if (minPriceInput) {
          minPriceInput.addEventListener("input", (e) => {
            formatPriceInputWithDots(e.target);
          });
          minPriceInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
              e.preventDefault();
              applyPriceFilter();
            }
          });
        }

        if (maxPriceInput) {
          maxPriceInput.addEventListener("input", (e) => {
            formatPriceInputWithDots(e.target);
          });
          maxPriceInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
              e.preventDefault();
              applyPriceFilter();
            }
          });
        }
      }

      // Format input v·ªõi d·∫•u ch·∫•m ngƒÉn c√°ch h√†ng ngh√¨n
      function formatPriceInputWithDots(input) {
        let cursorPosition = input.selectionStart;
        let oldValue = input.value;

        let numericValue = input.value.replace(/[^\d]/g, "");

        let formattedValue = "";
        if (numericValue) {
          formattedValue = parseInt(numericValue).toLocaleString("vi-VN");
        }

        input.value = formattedValue;

        if (formattedValue.length > oldValue.length) {
          cursorPosition++;
        } else if (formattedValue.length < oldValue.length) {
          cursorPosition--;
        }

        input.setSelectionRange(cursorPosition, cursorPosition);
      }

      // √Åp d·ª•ng l·ªçc theo gi√°
      function applyPriceFilter() {
        const minInput = document.getElementById("min-price");
        const maxInput = document.getElementById("max-price");

        if (!minInput || !maxInput) {
          console.error("Price inputs not found!");
          return;
        }

        const minVal = minInput.value.replace(/\./g, "").trim();
        const maxVal = maxInput.value.replace(/\./g, "").trim();

        console.log("Price filter values:", { minVal, maxVal });

        if (minVal && maxVal && parseInt(minVal) > parseInt(maxVal)) {
          alert("Gi√° t·ªëi thi·ªÉu kh√¥ng th·ªÉ l·ªõn h∆°n gi√° t·ªëi ƒëa!");
          return;
        }

        categoryFilters.minPrice = minVal ? parseInt(minVal) : null;
        categoryFilters.maxPrice = maxVal ? parseInt(maxVal) : null;

        console.log("Updated price filters:", categoryFilters);

        applyCategoryFilters();
        updateSelectedFilters();
        updateClearButton();
      }

      // √Åp d·ª•ng t·∫•t c·∫£ filters
      function applyCategoryFilters() {
        console.log("Applying filters:", categoryFilters);

        // GI·∫¢ ƒê·ªäNH getVisibleProducts() ƒê∆Ø·ª¢C ƒê·ªäNH NGHƒ®A TRONG main.js
        let products = getVisibleProducts(); // ƒê√£ l·ªçc category ·∫©n, status='active', v√† qty > 0 t·ª´ main.js
        console.log("Total products before filter:", products.length);

        // L·ªçc theo category t·ª´ URL
        if (categoryFilters.category) {
          products = products.filter(
            (p) => p.category === categoryFilters.category
          );
          console.log("After category filter:", products.length);
        }

        // L·ªçc theo subcategory t·ª´ URL
        if (categoryFilters.subcategory) {
          products = products.filter(
            (p) => p.subcategory === categoryFilters.subcategory
          );
          console.log("After URL subcategory filter:", products.length);
        }

        // ‚úÖ TH√äM M·ªöI: L·ªçc theo subcategory t·ª´ dropdown (n·∫øu kh√¥ng c√≥ subcategory t·ª´ URL)
        if (!categoryFilters.subcategory && categoryFilters.filterSubcategory) {
          products = products.filter(
            (p) => p.subcategory === categoryFilters.filterSubcategory
          );
          console.log("After dropdown subcategory filter:", products.length);
        }

        // L·ªçc theo gi√°
        if (categoryFilters.minPrice !== null) {
          products = products.filter(
            (p) => p.price >= categoryFilters.minPrice
          );
          console.log("After min price filter:", products.length);
        }

        if (categoryFilters.maxPrice !== null) {
          products = products.filter(
            (p) => p.price <= categoryFilters.maxPrice
          );
          console.log("After max price filter:", products.length);
        }

        // S·∫Øp x·∫øp
        if (categoryFilters.sortByName && categoryFilters.sortByAuthor) {
          products.sort((a, b) => {
            const nameCompare =
              categoryFilters.sortByName === "asc"
                ? a.name.localeCompare(b.name, "vi")
                : b.name.localeCompare(a.name, "vi");

            if (nameCompare === 0) {
              return categoryFilters.sortByAuthor === "asc"
                ? (a.author || "").localeCompare(b.author || "", "vi")
                : (b.author || "").localeCompare(a.author || "", "vi");
            }

            return nameCompare;
          });
          console.log("Sorted by name + author");
        } else if (categoryFilters.sortByName) {
          products.sort((a, b) => {
            return categoryFilters.sortByName === "asc"
              ? a.name.localeCompare(b.name, "vi")
              : b.name.localeCompare(a.name, "vi");
          });
          console.log("Sorted by name only");
        } else if (categoryFilters.sortByAuthor) {
          products.sort((a, b) => {
            return categoryFilters.sortByAuthor === "asc"
              ? (a.author || "").localeCompare(b.author || "", "vi")
              : (b.author || "").localeCompare(a.author || "", "vi");
          });
          console.log("Sorted by author only");
        }

        console.log("Final products count:", products.length);

        // H√ÄM N√ÄY C≈®NG C·∫¶N ƒê∆Ø·ª¢C ƒê·ªäNH NGHƒ®A TRONG main.js HO·∫∂C KH√ÅC
        currentList = products;
        renderProductList(1);
      }

      // Hi·ªÉn th·ªã filter tags
      function updateSelectedFilters() {
        const container = document.getElementById("selectedFilters");
        if (!container) return;

        let html = "<h1>T√¨m ki·∫øm n√¢ng cao: </h1>";
        let hasFilter = false;

        // T√™n
        if (categoryFilters.sortByName) {
          hasFilter = true;
          const direction =
            categoryFilters.sortByName === "asc" ? "A ‚Üí Z" : "Z ‚Üí A";
          html += `<span class="filter-tag">
      T√™n: ${direction}
      <span class="remove-filter" onclick="removeCategoryFilter('sortByName')">‚úï</span>
    </span>`;
        }

        // T√°c gi·∫£
        if (categoryFilters.sortByAuthor) {
          hasFilter = true;
          const direction =
            categoryFilters.sortByAuthor === "asc" ? "A ‚Üí Z" : "Z ‚Üí A";
          html += `<span class="filter-tag">
      T√°c gi·∫£: ${direction}
      <span class="remove-filter" onclick="removeCategoryFilter('sortByAuthor')">‚úï</span>
    </span>`;
        }

        // ‚úÖ TH√äM M·ªöI: Hi·ªÉn th·ªã tag cho subcategory filter
        if (categoryFilters.filterSubcategory) {
          hasFilter = true;
          html += `<span class="filter-tag">
      Th·ªÉ lo·∫°i: ${categoryFilters.filterSubcategory}
      <span class="remove-filter" onclick="removeCategoryFilter('filterSubcategory')">‚úï</span>
    </span>`;
        }

        // Gi√°
        if (
          categoryFilters.minPrice !== null ||
          categoryFilters.maxPrice !== null
        ) {
          hasFilter = true;
          let priceText = "Gi√°: ";
          if (
            categoryFilters.minPrice !== null &&
            categoryFilters.maxPrice !== null
          ) {
            priceText += `${categoryFilters.minPrice.toLocaleString(
              "vi-VN"
            )}‚Ç´ - ${categoryFilters.maxPrice.toLocaleString("vi-VN")}‚Ç´`;
          } else if (categoryFilters.minPrice !== null) {
            priceText += `T·ª´ ${categoryFilters.minPrice.toLocaleString(
              "vi-VN"
            )}‚Ç´`;
          } else {
            priceText += `ƒê·∫øn ${categoryFilters.maxPrice.toLocaleString(
              "vi-VN"
            )}‚Ç´`;
          }
          html += `<span class="filter-tag">
      ${priceText}
      <span class="remove-filter" onclick="removeCategoryFilter('price')">‚úï</span>
    </span>`;
        }

        container.innerHTML = html;
        container.style.display = hasFilter ? "block" : "none";
      }

      // X√≥a m·ªôt filter
      function removeCategoryFilter(filterType) {
        console.log("Removing filter:", filterType);

        switch (filterType) {
          case "sortByName":
            categoryFilters.sortByName = null;
            break;
          case "sortByAuthor":
            categoryFilters.sortByAuthor = null;
            break;
          case "filterSubcategory": // TH√äM M·ªöI
            categoryFilters.filterSubcategory = null;
            break;
          case "price":
            categoryFilters.minPrice = null;
            categoryFilters.maxPrice = null;
            const minInput = document.getElementById("min-price");
            const maxInput = document.getElementById("max-price");
            if (minInput) minInput.value = "";
            if (maxInput) maxInput.value = "";
            break;
        }

        applyCategoryFilters();
        updateSelectedFilters();
        updateClearButton();
      }

      // C·∫≠p nh·∫≠t n√∫t Clear
      function updateClearButton() {
        const clearBtn = document.querySelector(".clear-filters-btn");
        if (!clearBtn) return;

        const hasActiveFilter =
          categoryFilters.sortByName ||
          categoryFilters.sortByAuthor ||
          categoryFilters.filterSubcategory || // ‚úÖ TH√äM M·ªöI
          categoryFilters.minPrice !== null ||
          categoryFilters.maxPrice !== null;

        if (hasActiveFilter) {
          clearBtn.classList.add("active-clear");
        } else {
          clearBtn.classList.remove("active-clear");
        }
      }

      // Override renderProductList ƒë·ªÉ hi·ªÉn th·ªã t√°c gi·∫£
// GI·∫¢ ƒê·ªäNH perPage, currentPage, v√† currentList ƒê∆Ø·ª¢C KH·ªûI T·∫†O V√Ä S·ª¨ D·ª§NG TRONG main.js
function renderProductList(page = 1) {
    const wrap = document.getElementById("product-list");
    if (!wrap) return;

    currentPage = page;
    const all = currentList;
    const start = (page - 1) * perPage;
    const list = all.slice(start, start + perPage);

    wrap.innerHTML = list
        .map(
            (it) => `
    <div class="product-card">
      <img src="${it.img}" alt="${it.name}">
      <div class="product-info">
        <h3>${it.name}</h3>
        <p class="product-author">T√°c gi·∫£: ${it.author || "ƒêang c·∫≠p nh·∫≠t"}</p>
        <div class="price">${(it.price || 0).toLocaleString("vi-VN")}‚Ç´</div>
        <div class="button-row">
          <a class="btn btn-small" href="product-detail.html?id=${
            it.id
          }">Xem</a>
          <button class="btn btn-cart" onclick="addToCart(${
            it.id
          }, 1)">Th√™m v√†o gi·ªè</button>
        </div>
      </div>
    </div>
    `
        )
        .join("");

    // H√ÄM N√ÄY C≈®NG C·∫¶N ƒê∆Ø·ª¢C ƒê·ªäNH NGHƒ®A TRONG main.js HO·∫∂C KH√ÅC
    renderPagination(Math.ceil(all.length / perPage));
    
    // ‚≠ê TH√äM ƒêO·∫†N N√ÄY ƒê·ªÇ CU·ªòN TRANG SAU KHI PH√ÇN TRANG
    window.scrollTo({
        top: 0,
        behavior: 'smooth' // Cu·ªôn m∆∞·ª£t m√†
    });
}

      // Kh·ªüi t·∫°o khi DOM ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initCategoryPage);
      } else {
        initCategoryPage();
      }
    </script>
  </body>
</html>
